<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.2/dist/mindar-image-aframe.prod.js"></script>
    <style>
      .clickable { cursor: pointer; touch-action: manipulation; }
      /* Esconde o botão de VR do A-Frame que atrapalha no celular */
      .a-enter-vr { display: none; }
    </style>
  </head>
  <body>
    <a-scene mindar-image="imageTargetSrc: ./targets.mind; filterMinCF:0.0001; filterBeta: 0.001;" 
             color-space="sRGB" 
             renderer="colorManagement: true, physicallyCorrectLights" 
             vr-mode-ui="enabled: false" 
             device-orientation-permission-ui="enabled: false">

      <a-assets>
        <img id="img-1" src="./referencia.png" />
        <img id="img-2" src="./referencia2.png" /> 
        <img id="img-360" crossorigin="anonymous" src="https://live.staticflickr.com/65535/49927090358_a3135592b1_k.jpg" />
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: true">
        <a-entity position="0 0 -1"
                  cursor="fuse: false; rayOrigin: mouse;"
                  raycaster="far: 10000; objects: .clickable">
        </a-entity>
      </a-camera>

      <a-sky id="mundo-360" src="#img-360" visible="false" rotation="0 -90 0"></a-sky>
      
      <a-entity id="texto-360" visible="false" position="0 0 -2">
           <a-plane color="#0A2A43" width="1.5" height="0.4" opacity="0.9"></a-plane>
           <a-text id="txt-conteudo-360" value="" align="center" width="1.4" wrap-count="45" position="0 0 0.01"></a-text>
      </a-entity>


      <a-entity mindar-image-target="targetIndex: 0">
        
        <a-entity id="grupo-2-ar" visible="false">
             <a-plane src="#img-2" position="0 0.3 0" height="0.9" width="1.2"></a-plane>
            <a-entity position="0 -0.3 0.1">
                <a-plane color="#0A2A43" width="1.2" height="0.3" opacity="0.95"></a-plane>
                <a-text id="txt-conteudo-2" value="" align="center" width="1.1" wrap-count="45" position="0 0 0.01"></a-text>
            </a-entity>
        </a-entity>

        <a-entity id="menu-idioma" visible="true">
            <a-entity position="0 0 0.2">
                 <a-plane color="#0A2A43" width="1.2" height="0.2" opacity="0.9"></a-plane>
                 <a-text value="Select Language / Selecione" align="center" width="1.5" position="0 0 0.01"></a-text>
            </a-entity>
            <a-entity id="btn-pt" class="clickable" position="-0.3 -0.3 0.2">
                <a-plane color="#8B6F47" width="0.55" height="0.2" class="clickable" opacity="1"></a-plane>
                <a-text value="Portugues" color="#F2F5F9" align="center" width="1.8" position="0 0 0.01"></a-text>
            </a-entity>
            <a-entity id="btn-en" class="clickable" position="0.3 -0.3 0.2">
                <a-plane color="#C9A66B" width="0.55" height="0.2" class="clickable" opacity="1"></a-plane>
                <a-text value="English" color="#0A2A43" align="center" width="1.8" position="0 0 0.01"></a-text>
            </a-entity>
        </a-entity>

        <a-entity id="menu-principal" visible="false">
            <a-entity id="btn-1" class="clickable" position="-0.3 -0.65 0.2">
                <a-plane color="#8B6F47" width="0.55" height="0.2" class="clickable" opacity="1"></a-plane>
                <a-text id="txt-btn-1" value="..." color="#F2F5F9" align="center" width="1.8" position="0 0 0.01"></a-text>
            </a-entity>
            <a-entity id="btn-2" class="clickable" position="0.3 -0.65 0.2">
                <a-plane color="#C9A66B" width="0.55" height="0.2" class="clickable" opacity="1"></a-plane>
                <a-text id="txt-btn-2" value="..." color="#0A2A43" align="center" width="1.8" position="0 0 0.01"></a-text>
            </a-entity>
        </a-entity>

      </a-entity>
    </a-scene>

    <script>
      // === 1. DICIONÁRIO DE TEXTOS ===
      const traducoes = {
          'pt': {
              btn1: "Entrar na Antiga (360)", // Mudei o texto para indicar imersão
              btn2: "Ver Nova (AR)",
              desc360: "Voce esta dentro da representacao da Antiga Matriz (1943-1968). Gire o celular para explorar.",
              desc2: "A Catedral Metropolitana atual, inaugurada em 1972. Projeto moderno de Edoardo Rosso."
          },
          'en': {
              btn1: "Enter Old Church (360)",
              btn2: "See New (AR)",
              desc360: "You are inside the representation of the Old Cathedral (1943-1968). Rotate your phone to explore.",
              desc2: "The current Metropolitan Cathedral, inaugurated in 1972. Modern design by Edoardo Rosso."
          }
      };

      // Referências
      const menuIdioma = document.querySelector("#menu-idioma");
      const menuPrincipal = document.querySelector("#menu-principal");
      const btnPT = document.querySelector("#btn-pt");
      const btnEN = document.querySelector("#btn-en");
      const btn1 = document.querySelector("#btn-1");
      const btn2 = document.querySelector("#btn-2");
      
      // Novos elementos 360 e AR
      const mundo360 = document.querySelector("#mundo-360");
      const texto360Group = document.querySelector("#texto-360");
      const txtConteudo360 = document.querySelector("#txt-conteudo-360");
      const grupo2AR = document.querySelector("#grupo-2-ar");
      
      const txtConteudo2 = document.querySelector("#txt-conteudo-2");
      const txtBtn1 = document.querySelector("#txt-btn-1");
      const txtBtn2 = document.querySelector("#txt-btn-2");
      
      let idiomaAtual = 'pt'; // Padrão

      // === 2. LÓGICA DE SELEÇÃO DE IDIOMA ===
      function selecionarIdioma(lang) {
          idiomaAtual = lang;
          txtBtn1.setAttribute("value", traducoes[lang].btn1);
          txtBtn2.setAttribute("value", traducoes[lang].btn2);
          // Já deixa os textos de conteúdo prontos
          txtConteudo360.setAttribute("value", traducoes[lang].desc360);
          txtConteudo2.setAttribute("value", traducoes[lang].desc2);

          menuIdioma.setAttribute("visible", false);
          menuIdioma.setAttribute("position", "0 100 0"); 
          menuPrincipal.setAttribute("visible", true);
      }

      btnPT.addEventListener('click', () => selecionarIdioma('pt'));
      btnEN.addEventListener('click', () => selecionarIdioma('en'));


      // === 3. LÓGICA PRINCIPAL (ALTERNAR MODOS) ===
      
      const corBtn1 = "#8B6F47"; 
      const corBtn2 = "#C9A66B"; 

      function feedbackClique(element, corOriginal) {
        const plane = element.querySelector("a-plane");
        plane.setAttribute("color", "#F2F5F9"); 
        setTimeout(() => { plane.setAttribute("color", corOriginal); }, 150);
      }

      // CLIQUE NO BOTÃO 1: ATIVA MODO 360
      btn1.addEventListener('click', function (evt) {
        feedbackClique(btn1, corBtn1); 
        
        // Esconde o conteúdo AR da nova catedral
        grupo2AR.setAttribute("visible", false);
        
        // Mostra o mundo 360 e seu texto
        mundo360.setAttribute("visible", true);
        texto360Group.setAttribute("visible", true);
      });

      // CLIQUE NO BOTÃO 2: ATIVA MODO AR
      btn2.addEventListener('click', function (evt) {
        feedbackClique(btn2, corBtn2);

        // Esconde o mundo 360
        mundo360.setAttribute("visible", false);
        texto360Group.setAttribute("visible", false);

        // Mostra o conteúdo AR da nova catedral
        grupo2AR.setAttribute("visible", true);
      });
    </script>
  </body>
</html>